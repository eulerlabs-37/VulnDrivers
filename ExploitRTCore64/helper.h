#ifndef HELPER_H
#define HELPER_H

#include <Windows.h>

#define OFFSET_LDR_DATA_TABLE_ENTRY_BASE_DLL_NAME 0x58
#define OFFSET_UNICODE_STRING_BUFFER 0x08
#define OFFSET_DLLBASE 0x30
#define OFFSET_SIZEOFIMAGE 0x40
#define OFFSET_NUMBER_OF_SECTIONS 0x06
#define OFFSET_SECTION_HEADERS 0x108

#define BASE_DLL_NAME_BUFFER_LENGTH   256
#define SECTION_NAME_LENGTH 8


BOOL getModuleName(DWORD64 moduleListEntry, char* moduleName);
BOOL readSection(const char* driverName);
ULONG_PTR GetAddressKernelBase();
DWORD GetOffsetPsLoadedModuleList();
BOOL InitPsLoadedModuleList();

#endif // HELPER_H